<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'>
  <link rel="stylesheet" type="text/css" href="css/typo.css" />
  <link rel="stylesheet" type="text/css" href="css/tlcl.css" />
  <link rel="icon" type="image/png" href="../images/billi66.png" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TLCL</title>
</head>

<body>

<div id="wrapper" class="typo">

<a href="index.html">目錄</a>
<h1 style="text-align:center">vi 簡介</h1><br>
<p>There is an old joke about a visitor to New York City asking a passerby for directions to
the city’s famous classical music venue:</p>

<p>Visitor: Excuse me, how do I get to Carnegie Hall?</p>

<p>Passerby: Practice, practice, practice!</p>

<p>有一個古老的笑話，說是一個在紐約的遊客向行人打聽這座城市中著名古典音樂場館的方向：</p>

<p>遊客： 請問一下，我怎樣去卡內基音樂大廳？</p>

<p>行人： 練習，練習，練習!</p>

<p>Learning the Linux command line, like becoming an accomplished pianist, is not
something that we pick up in an afternoon. It takes years of practice. In this chapter, we
will introduce the vi (pronounced “vee eye”) text editor, one of the core programs in the
Unix tradition. vi is somewhat notorious for its difficult user interface, but when we see
a master sit down at the keyboard and begin to “play,” we will indeed be witness to some
great art. We won’t become masters in this chapter, but when we are done, we will know
how to play “chopsticks” in vi.</p>

<p>學習 Linux 命令列，就像要成為一名造詣很深的鋼琴家一樣，它不是我們一下午就能學會的技能。這需要
經歷幾年的勤苦練習。在這一章中，我們將介紹 vi（發音“vee eye”）文字編輯器，它是 Unix 傳統中核心程式之一。
vi 因它難用的使用者介面而有點聲名狼藉，但是當我們看到一位大師坐在鋼琴前開始演奏時，我們的確成了
偉大藝術的見證人。雖然我們在這裡不能成為 vi 大師，但是當我們學完這一章後，
我們會知道怎樣在 vi 中彈奏像“Chopsticks”那樣的鋼琴小品。</p>

<p>Why We Should Learn vi</p>

<h3 id="為什麼我們應該學習-vi">為什麼我們應該學習 vi</h3>

<p>In this modern age of graphical editors and easy-to-use text-based editors such as nano,
why should we learn vi? There are three good reasons:</p>

<p>在現在這個圖形化編輯器和易於使用的基於文字編輯器的時代，比如說 nano，為什麼我們還應該學習 vi 呢？
下面有三個充分的理由：</p>

<ul>
  <li>
    <p>vi is always available. This can be a lifesaver if we have a system with no
graphical interface, such as a remote server or a local system with a broken X
configuration. nano, while increasingly popular is still not universal. POSIX, a
standard for program compatibility on Unix systems, requires that vi be present.</p>
  </li>
  <li>
    <p>vi 很多系統都預裝。如果我們的系統沒有圖形介面，比方說一臺遠端伺服器或者是一個
X 配置損壞了的本地系統，那麼 vi 就成了我們的救星。雖然 nano 逐漸流行起來，但是它
還沒有普及。POSIX，這套 Unix 系統中程式相容的標準，就要求系統要預裝 vi。</p>
  </li>
  <li>
    <p>vi is lightweight and fast. For many tasks, it’s easier to bring up vi than it is to
find the graphical text editor in the menus and wait for its multiple megabytes to
load. In addition, vi is designed for typing speed. As we shall see, a skilled vi
user never has to lift his or her fingers from the keyboard while editing.</p>
  </li>
  <li>
    <p>vi 輕量級且執行快。對於許多工來說，啟動 vi 比起在選單中找到一個圖形化文字編輯器，
  再等待其數倍兆位元組的資料載入而言，要容易的多。另外，vi 是為了加快輸入速度而設計的。
我們將會看到，當一名熟練的 vi 使用者在編輯檔案時，他或她的手從不需要移開鍵盤。</p>
  </li>
  <li>
    <p>We don’t want other Linux and Unix users to think we are sissies.</p>
  </li>
  <li>
    <p>我們不希望其他 Linux 和 Unix 使用者把我們看作膽小鬼。</p>
  </li>
</ul>

<p>Okay, maybe two good reasons.</p>

<p>好吧，可能只有兩個充分的理由。</p>

<p>A Little Background</p>

<h3 id="一點背景介紹">一點背景介紹</h3>

<p>The first version of vi was written in 1976 by Bill Joy, a University of California at
Berkley student who later went on to co-found Sun Microsystems. vi derives its name
from the word “visual,” because it was intended to allow editing on a video terminal with
a moving cursor. Previous to visual editors, there were line editors which operated on a
single line of text at a time. To specify a change, we tell a line editor to go to a particular
line and describe what change to make, such as adding or deleting text. With the advent
of video terminals (rather than printer-based terminals like teletypes) visual editing
became possible. vi actually incorporates a powerful line editor called ex, and we can
use line editing commands while using vi.</p>

<p>第一版 vi 是在1976由 Bill Joy 寫成的，當時他是加州大學伯克利分校的學生，
後來他共同建立了 Sun 微系統公司。vi 這個名字
來源於單詞“visual”，因為它打算在帶有可移動游標的視訊終端上編輯文字。在發明視覺化編輯器之前，
有一次只能操作一行文字的行編輯器。為了編輯，我們需要告訴行編輯器到一個特殊行並且
說明做什麼修改，比方說新增或刪除文字。視訊終端（而不是基於印表機的終端，像電傳印表機）的出現
，使視覺化編輯成為可能。vi 實際上整合了一個強大的行編輯器 ———— ex ,
所以我們在使用 vi 時能執行行編輯命令。</p>

<p>Most Linux distributions don’t include real vi; rather, they ship with an enhanced
replacement called vim (which is short for “vi improved”) written by Bram Moolenaar.
vim is a substantial improvement over traditional Unix vi and is usually symbolically
linked (or aliased) to the name “vi” on Linux systems. In the discussions that follow, we
will assume that we have a program called “vi” that is really vim.</p>

<p>大多數 Linux 發行版不包含真正的 vi；而是自帶一款高階替代版本，叫做 vim（它是“vi
improved”的簡寫）由 Bram Moolenaar 開發的。vim 相對於傳統的 Unix
vi 來說，取得了實質性進步。通常，vim 在 Linux 系統中是“vi”的符號連結（或別名）。
在隨後的討論中，我們將會假定我們有一個叫做“vi”的程式，但它其實是 vim。</p>

<p>Starting And Stopping vi</p>

<h3 id="啟動和退出-vi">啟動和退出 vi</h3>

<p>To start vi, we simply type the following:</p>

<p>要想啟動 vi，只要簡單地輸入以下命令：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[me@linuxbox ~]$ vi
</code></pre></div></div>

<p>And a screen like this should appear:</p>

<p>一個像這樣的螢幕應該出現：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>VIM - Vi Improved
....
</code></pre></div></div>

<p>Just as we did with nano earlier, the first thing to learn is how to exit. To exit, we enter
the following command (note that the colon character is part of the command):</p>

<p>正如我們之前操作 nano 時，首先要學的是怎樣退出 vi。要退出 vi，輸入下面的命令（注意冒號是命令的一部分）：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:q
</code></pre></div></div>

<p>The shell prompt should return. If, for some reason, vi will not quit (usually because we
made a change to a file that has not yet been saved), we can tell vi that we really mean it
by adding an exclamation point to the command:</p>

<p>shell 提示符應該重新出現。如果由於某種原因，vi 不能退出（通常因為我們對檔案做了修改，卻沒有儲存檔案）。
透過給命令加上歎號，我們可以告訴 vi 我們真要退出 vi。（注意感嘆號是命令的一部分）</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:q!
</code></pre></div></div>

<p>Tip: If you get “lost” in vi, try pressing the Esc key twice to find your way again.</p>

<p>小貼示：如果你在 vi 中“迷失”了，試著按下 Esc 鍵兩次來回到普通模式。</p>

<blockquote>
  <p>Compatibility Mode</p>

  <p>相容模式</p>

  <p>In the example startup screen above (taken from Ubuntu 8.04), we see the text
“Running in Vi compatible mode.” This means that vim will run in a mode that
is closer to the normal behavior of vi rather than the enhanced behavior of vim.
For purposes of this chapter, we will want to run vim with its enhanced behavior.
To do this, you have a few options:</p>

  <p>在上面的截圖中（來自於 Ubuntu
8.04），我們看到一行文字 “運行於 Vi 相容模式。” 這意味著 vim 將以近似於 vi 的普通的模式
執行，而不是以 vim 的進階的模式執行。出於本章的教學目的，我們將使用 vim 和它的的高階模式。
要這樣使用vim，可以透過如下方法：</p>

  <p>Try running vim instead of vi.</p>

  <p>用 vim 來代替 vi。</p>

  <p>If that works, consider adding alias vi=’vim’ to your .bashrc file.</p>

  <p>如果命令生效，考慮在你的.bashrc 檔案中新增 alias vi=’vim’。</p>

  <p>Alternately, use this command to add a line to your vim configuration file:</p>

  <p>或者，使用以下命令在你的 vim 配置檔案中新增一行：</p>

  <p><em>echo “set nocp” &gt;&gt; ~/.vimrc</em></p>

  <p>Different Linux distributions package vim in different ways. Some distributions
install a minimal version of vim by default that only supports a limiting set of
vim features. While preforming the lessons that follow, you may encounter
missing features. If this is the case, install the full version of vim.</p>

  <p>不同 Linux 發行版自帶的 vim 軟體包各不相同。一些發行版預裝了 vim 的最簡版，
其只支援很有限的 vim 特性。在隨後練習裡，你可能發現你的 vim 缺失一些特性。
若是如此，請安裝 vim 的完整版。</p>
</blockquote>

<p>Editing Modes</p>

<h3 id="編輯模式">編輯模式</h3>

<p>Let's start up vi again, this time passing to it the name of a nonexistent file. This is how
we can create a new file with vi:</p>

<p>再次啟動 vi，這次傳遞給 vi 一個不存在的檔名。這也是用 vi 建立新檔案的方法。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[me@linuxbox ~]$ rm -f foo.txt
[me@linuxbox ~]$ vi foo.txt
</code></pre></div></div>

<p>If all goes well, we should get a screen like this:</p>

<p>如果一切正常，我們應該獲得一個像這樣的螢幕：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>....
"foo.txt" [New File]
</code></pre></div></div>

<p>The leading tilde characters (”~”) indicate that no text exists on that line. This shows that
we have an empty file. Do not type anything yet!</p>

<p>每行開頭的波浪號（”~”）表示那一行沒有文字。這裡我們有一個空檔案。先別進行輸入！</p>

<p>The second most important thing to learn about vi (after learning how to exit) is that vi
is a modal editor. When vi starts up, it begins in command mode. In this mode, almost
every key is a command, so if we were to start typing, vi would basically go crazy and
make a big mess.</p>

<p>關於 vi ，第二重要的事是知曉vi 是一個模式編輯器。（第一件事是如何退出 vi ）vi 啟動後會直接進入
命令模式。這種模式下，幾乎每個按鍵都是一個命令，所以如果我們直接輸入文字，vi 會發瘋，弄得一團糟。</p>

<p>Entering Insert Mode</p>

<h4 id="插入模式">插入模式</h4>

<p>In order to add some text to our file, we must first enter insert mode. To do this, we press
the “i” key. Afterwards, we should see the following at the bottom of the screen if vim is
running in its usual enhanced mode (this will not appear in vi compatible mode):</p>

<p>為了在檔案中新增文字，我們需要先進入插入模式。按下”i”鍵進入插入模式。之後，我們應當
在螢幕底部看到如下的資訊，如果 vi 執行在高階模式下（ vi 在相容模式下不會顯示這行資訊）：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-- INSERT --
</code></pre></div></div>

<p>Now we can enter some text. Try this:</p>

<p>現在我們能輸入一些文字了。試著輸入這些文字：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The quick brown fox jumped over the lazy dog.
</code></pre></div></div>

<p>To exit insert mode and return to command mode, press the Esc key.</p>

<p>若要退出插入模式返回命令模式，按下 Esc 按鍵。</p>

<p>Saving Our Work</p>

<h4 id="儲存我們的工作">儲存我們的工作</h4>

<p>To save the change we just made to our file, we must enter an ex command while in
command mode. This is easily done by pressing the “:” key. After doing this, a colon
character should appear at the bottom of the screen:</p>

<p>為了儲存我們剛才對檔案所做的修改，我們必須在命令模式下輸入一個 ex 命令。
透過按下”:”鍵，這很容易完成。按下冒號鍵之後，一個冒號字元應該出現在螢幕的底部：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:
</code></pre></div></div>

<p>To write our modified file, we follow the colon with a “w” then Enter:</p>

<p>為了寫入我們修改的檔案，我們在冒號之後輸入”w”字元，然後按下回車鍵：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:w
</code></pre></div></div>

<p>The file will be written to the hard drive and we should get a confirmation message at the
bottom of the screen, like this:</p>

<p>檔案將會寫入到硬碟，而且我們會在螢幕底部看到一行確認資訊，就像這樣：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"foo.txt" [New] 1L, 46C written
</code></pre></div></div>

<p>Tip: If you read the vim documentation, you will notice that (confusingly)
command mode is called normal mode and ex commands are called command
mode. Beware.</p>

<p>小貼示：如果你閱讀 vim 的文件，你會發現命令模式被（令人困惑地）叫做普通模式，ex 命令
叫做命令模式。當心。</p>

<p>Moving The Cursor Around</p>

<h3 id="移動游標">移動游標</h3>

<p>While in command mode, vi offers a large number of movement commands, some of
which it shares with less. Here is a subset:</p>

<p>當在 vi 命令模式下時，vi 提供了大量的移動命令，其中一些與 less 閱讀器的相同。這裡
列舉了一些：</p>

<table class="multi">
<caption class="cap">Table 13-1: Cursor Movement Keys</caption>
<tr>
<th class="title">Key</th>
<th class="title">Move The Cursor</th>
</tr>
<tr>
<td valign="top" width="25%">l or Right Arrow </td>
<td valign="top">Right one character.</td>
</tr>
<tr>
<td valign="top">h or Left Arrow </td>
<td valign="top">Left one character</td>
</tr>
<tr>
<td valign="top">j or Down Arrow</td>
<td valign="top">Down one line</td>
</tr>
<tr>
<td valign="top">k or Up Arrow </td>
<td valign="top">Up one line</td>
</tr>
<tr>
<td valign="top">0 (zero) </td>
<td valign="top">To the beginning of the current line.</td>
</tr>
<tr>
<td valign="top">^</td>
<td valign="top">To the first non-whitespace character on the current line.</td>
</tr>
<tr>
<td valign="top">$</td>
<td valign="top">To the end of the current line.</td>
</tr>
<tr>
<td valign="top">w</td>
<td valign="top">To the beginning of the next word or puntuation character.</td>
</tr>
<tr>
<td valign="top">W</td>
<td valign="top">To the beginning of the next word, ignoring puntuation character.</td>
</tr>
<tr>
<td valign="top">b</td>
<td valign="top">To the beginning of the previous word or punctuation character.</td>
</tr>
<tr>
<td valign="top">B</td>
<td valign="top">To the beginning of the previous word, ignoring
punctuation characters.</td>
</tr>
<tr>
<td valign="top">Ctrl-f or Page Down </td>
<td valign="top">Down one page.</td>
</tr>
<tr>
<td valign="top">Ctrl-b or Page Up </td>
<td valign="top">Up one page.</td>
</tr>
<tr>
<td valign="top">numberG</td>
<td valign="top">To line number. For example, 1G moves to the first
line of the file.</td>
</tr>
<tr>
<td valign="top">G</td>
<td valign="top">To the last line of the file.</td>
</tr>
</table>

<table class="multi">
<caption class="cap">表13-1: 游標移動按鍵</caption>
<tr>
<th class="title">按鍵</th>
<th class="title">移動游標</th>
</tr>
<tr>
<td valign="top" width="25%">l or 右箭頭</td>
<td valign="top">向右移動一個字元</td>
</tr>
<tr>
<td valign="top">h or 左箭頭</td>
<td valign="top">向左移動一個字元</td>
</tr>
<tr>
<td valign="top">j or 下箭頭</td>
<td valign="top">向下移動一行</td>
</tr>
<tr>
<td valign="top">k or 上箭頭</td>
<td valign="top">向上移動一行</td>
</tr>
<tr>
<td valign="top">0 (零按鍵) </td>
<td valign="top">移動到當前行的行首。</td>
</tr>
<tr>
<td valign="top">^</td>
<td valign="top">移動到當前行的第一個非空字元。</td>
</tr>
<tr>
<td valign="top">$</td>
<td valign="top">移動到當前行的末尾。</td>
</tr>
<tr>
<td valign="top">w</td>
<td valign="top">移動到下一個單詞或標點符號的開頭。</td>
</tr>
<tr>
<td valign="top">W</td>
<td valign="top">移動到下一個單詞的開頭，忽略標點符號。</td>
</tr>
<tr>
<td valign="top">b</td>
<td valign="top">移動到上一個單詞或標點符號的開頭。</td>
</tr>
<tr>
<td valign="top">B</td>
<td valign="top">移動到上一個單詞的開頭，忽略標點符號。</td>
</tr>
<tr>
<td valign="top">Ctrl-f or Page Down </td>
<td valign="top">向下翻一頁</td>
</tr>
<tr>
<td valign="top">Ctrl-b or Page Up </td>
<td valign="top">向上翻一頁</td>
</tr>
<tr>
<td valign="top">numberG</td>
<td valign="top">移動到第 number 行。例如，1G 移動到檔案的第一行。</td>
</tr>
<tr>
<td valign="top">G</td>
<td valign="top">移動到檔案末尾。</td>
</tr>
</table>

<p>Why are the h, j, k, and l keys used for cursor movement? Because when vi was
originally written, not all video terminals had arrow keys, and skilled typists could use
regular keyboard keys to move the cursor without ever having to lift their fingers from
the keyboard.</p>

<p>為什麼 h，j，k，和 l 按鍵被用來移動游標呢？因為在開發 vi 之初，並不是所有的視訊終端都有
箭頭按鍵，熟練的打字員可以使用組合鍵來移動游標，他們的手指從不需要移開鍵盤。</p>

<p>Many commands in vi can be prefixed with a number, as with the “G” command listed
above. By prefixing a command with a number, we may specify the number of times a
command is to be carried out. For example, the command “5j” causes vi to move the
cursor down five lines.</p>

<p>vi 中的許多命令都可以在前面加上一個數字，比方說上面提到的”G”命令。在命令之前加上一個
數字，我們就可以指定命令執行的次數。例如，命令”5j”將游標下移5行。</p>

<p>Basic Editing</p>

<h3 id="基本編輯">基本編輯</h3>

<p>Most editing consists of a few basic operations such as inserting text, deleting text and
moving text around by cutting and pasting. vi, of course, supports all of these
operations in its own unique way. vi also provides a limited form of undo. If we press
the “u” key while in command mode, vi will undo the last change that you made. This
will come in handy as we try out some of the basic editing commands.</p>

<p>大多數編輯工作由一些基本的操作組成，比如說插入文字，刪除文字和透過剪下和貼上來移動文字。
vi，當然，有它獨特方式來實現所有的操作。vi 也提供了撤銷功能，但有些限制。如果我們按下“u”
按鍵，當在命令模式下，vi 將會撤銷你所做的最後一次修改。當我們試著執行一些基本的
編輯命令時，這會很方便。</p>

<p>Appending Text</p>

<h4 id="追加文字">追加文字</h4>

<p>vi has several different ways of entering insert mode. We have already used the i
command to insert text.</p>

<p>vi 有幾種不同進入插入模式的方法。我們已經使用了 i 命令來插入文字。</p>

<p>Let's go back to our foo.txt file for a moment:</p>

<p>讓我們再次進入到我們的 foo.txt 檔案：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The quick brown fox jumped over the lazy dog.
</code></pre></div></div>

<p>If we wanted to add some text to the end of this sentence, we would discover that the i
command will not do it, since we can’t move the cursor beyond the end of the line. vi
provides a command to append text, the sensibly named “a” command. If we move the
cursor to the end of the line and type “a”, the cursor will move past the end of the line
and vi will enter insert mode. This will allow us to add some more text:</p>

<p>如果我們想要在這個句子的末尾新增一些文字，我們會發現 i 命令不能完成任務，因為我們不能把
游標移到行尾。vi 提供了追加文字的命令，明智地命名為”a”。如果我們把游標移動到行尾，輸入”a”,
游標就會越過行尾，同時 vi 會進入插入模式。這讓我們能新增文字到行末：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The quick brown fox jumped over the lazy dog. It was cool.
</code></pre></div></div>

<p>Remember to press the Esc key to exit insert mode.</p>

<p>記得按 Esc 鍵來退出插入模式。</p>

<p>Since we will almost always want to append text to the end of a line, vi offers a shortcut
to move to end of the current line and start appending. It’s the “A” command. Let's try it
and add some more lines to our file.</p>

<p>因為我們幾乎總是想要在行尾新增文字，所以 vi 提供了一個快捷鍵。游標將移動到行尾，同時 vi 進入輸入模式。
它是”A”命令。試著用一下它，向檔案新增更多行。</p>

<p>First, we’ll move the cursor to the beginning of the line using the “0” (zero) command.
Now we type “A” and add the following lines of text:</p>

<p>首先，使用”0”(零)命令，將游標移動到行首。現在我們輸入”A”，然後輸入下面這些文字：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The quick brown fox jumped over the lazy dog. It was cool.
Line 2
Line 3
Line 4
Line 5
</code></pre></div></div>

<p>Again, press the Esc key to exit insert mode.</p>

<p>再一次，按下 Esc 鍵退出插入模式。</p>

<p>As we can see, the “A” command is more useful as it moves the cursor to the end of the
line before starting insert mode.</p>

<p>正如我們所看到的， “A” 命令非常有用，因為它在進入到插入模式前，先將游標移到了行尾。</p>

<p>Opening A Line</p>

<h4 id="開啟一行">開啟一行</h4>

<p>Another way we can insert text is by “opening” a line. This inserts a blank line between
two existing lines and enters insert mode. This has two variants:</p>

<p>我們插入文字的另一種方式是“開啟（open）”一行。這會在兩行之間插入一個空白行，並且進入到插入模式。
這種方式有兩個變體：</p>

<table class="multi">
<caption class="cap">Table 13-2: Line Opening Keys</caption>
<tr>
<th class="title">Command </th>
<th class="title">Opens</th>
</tr>
<tr>
<td valign="top" width="25%">o</td>
<td valign="top">The line below the current line.</td>
</tr>
<tr>
<td valign="top">O</td>
<td valign="top">The line above the current line.</td>
</tr>
</table>

<table class="multi">
<caption class="cap">表13-2: 文字行開啟按鍵</caption>
<tr>
<th class="title">命令</th>
<th class="title">開啟行</th>
</tr>
<tr>
<td valign="top" width="25%">o</td>
<td valign="top">當前行的下方開啟一行。</td>
</tr>
<tr>
<td valign="top">O</td>
<td valign="top">當前行的上方開啟一行。</td>
</tr>
</table>

<p>We can demonstrate this as follows: place the cursor on “Line 3” then press the o key.</p>

<p>我們可以示範一下：把游標移到”Line 3”上，再按下小 o 按鍵。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The quick brown fox jumped over the lazy dog. It was cool.
Line 2
Line 3

line 4
line 5
</code></pre></div></div>

<p>A new line was opened below the third line and we entered insert mode. Exit insert mode
by pressing the Esc key. Press the u key to undo our change.</p>

<p>在第三行之下打開了新的一行，並且進入插入模式。按下 Esc，退出插入模式。按下 u 按鍵，撤銷我們的修改。</p>

<p>Press the O key to open the line above the cursor:</p>

<p>按下大 O 按鍵在游標之上開啟新的一行：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The quick brown fox jumped over the lazy dog. It was cool.
Line 2

Line 3
Line 4
Line 5
</code></pre></div></div>

<p>Exit insert mode by pressing the Esc key and undo our change by pressing u.</p>

<p>按下 Esc 按鍵，退出插入模式，並且按下 u 按鍵，撤銷我們的更改。</p>

<p>Deleting Text</p>

<h4 id="刪除文字">刪除文字</h4>

<p>As we might expect, vi offers a variety of ways to delete text, all of which contain one
of two keystrokes. First, the x key will delete a character at the cursor location. x may
be preceded by a number specifying how many characters are to be deleted. The d key is
more general purpose. Like x, it may be preceded by a number specifying the number of
times the deletion is to be performed. In addition, d is always followed by a movement
command that controls the size of the deletion. Here are some examples:</p>

<p>正如我們所願，vi 提供了各種刪除文字到的方法，而且只需一或兩個按鍵。首先，
x 按鍵會刪除游標位置的一個字元。可以在 x 命令之前帶上一個數字，來指明要刪除的字元個數。
d 按鍵更通用一些。跟 x 命令一樣，d 命令之前可以帶上一個數字，來指定要執行的刪除次數。另外，
d 命令之後總是帶上一個移動命令，用來控制刪除的範圍。這裡有些範例：</p>

<table class="multi">
<caption class="cap">Table 13-3: Text Deletion Commands</caption>
<tr>
<th class="title">Command</th>
<th class="title">Deletes</th>
</tr>
<tr>
<td valign="top" width="25%">x</td>
<td valign="top">The current character.</td>
</tr>
<tr>
<td valign="top">3x</td>
<td valign="top">The current character and the next two character.</td>
</tr>
<tr>
<td valign="top" width="25%">dd</td>
<td valign="top">The current line.</td>
</tr>
<tr>
<td valign="top" width="25%">5dd</td>
<td valign="top">The current line and the next four lines.</td>
</tr>
<tr>
<td valign="top" width="25%">dW</td>
<td valign="top">From the cursor position to the beginning of the next word.</td>
</tr>
<tr>
<td valign="top" width="25%">d$</td>
<td valign="top">From the cursor position to the end of the current line.</td>
</tr>
<tr>
<td valign="top" width="25%">d0</td>
<td valign="top">From the cursor position to the beginning of the current line.</td>
</tr>
<tr>
<td valign="top" width="25%">d^</td>
<td valign="top">From the cursor position to the first non-whitespace character of the line.</td>
</tr>
<tr>
<td valign="top" width="25%">dG</td>
<td valign="top">From the current line to the end of the file.</td>
</tr>
<tr>
<td valign="top" width="25%">d20G</td>
<td valign="top">From the current line to the twentieth line of the file.</td>
</tr>
</table>

<table class="multi">
<caption class="cap">表13-3: 文字刪除命令</caption>
<tr>
<th class="title">命令</th>
<th class="title">刪除的文字</th>
</tr>
<tr>
<td valign="top" width="25%">x</td>
<td valign="top">當前字元</td>
</tr>
<tr>
<td valign="top">3x</td>
<td valign="top">當前字元及其後的兩個字元。</td>
</tr>
<tr>
<td valign="top" width="25%">dd</td>
<td valign="top">當前行。</td>
</tr>
<tr>
<td valign="top" width="25%">5dd</td>
<td valign="top">當前行及隨後的四行文字。</td>
</tr>
<tr>
<td valign="top" width="25%">dW</td>
<td valign="top">從游標位置開始到下一個單詞的開頭。</td>
</tr>
<tr>
<td valign="top" width="25%">d$</td>
<td valign="top">從游標位置開始到當前行的行尾。</td>
</tr>
<tr>
<td valign="top" width="25%">d0</td>
<td valign="top">從游標位置開始到當前行的行首。</td>
</tr>
<tr>
<td valign="top" width="25%">d^</td>
<td valign="top">從游標位置開始到文字行的第一個非空字元。</td>
</tr>
<tr>
<td valign="top" width="25%">dG</td>
<td valign="top">從當前行到檔案的末尾。</td>
</tr>
<tr>
<td valign="top" width="25%">d20G</td>
<td valign="top">從當前行到檔案的第20行。</td>
</tr>
</table>

<p>Place the cursor on the word “It” on the first line of our text. Press the x key repeatedly
until the rest of the sentence is deleted. Next, press the u key repeatedly until the
deletion is undone.</p>

<p>把游標放到第一行單詞“It”之上。重複按下 x 按鍵直到刪除剩下的部分。下一步，重複按下 u 按鍵
直到恢復原貌。</p>

<p>Note: Real vi only supports a single level of undo. vim supports multiple levels.</p>

<p>注意：真正的 vi 只是支援單層面的 undo 命令。vim 則支援多個層面的。</p>

<p>Let's try the deletion again, this time using the d command. Again, move the cursor to
the word “It” and press dW to delete the word:</p>

<p>我們再次執行刪除命令，這次使用 d 命令。還是移動游標到單詞”It”之上，按下的 dW 來刪除單詞：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The quick brown fox jumped over the lazy dog. was cool.
Line 2
Line 3
Line 4
Line 5
</code></pre></div></div>

<p>Press d$ to delete from the cursor position to the end of the line:</p>

<p>按下 d$刪除從游標位置到行尾的文字：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The quick brown fox jumped over the lazy dog.
Line 2
Line 3
Line 4
Line 5
</code></pre></div></div>

<p>Press dG to delete from the current line to the end of the file:</p>

<p>按下 dG 按鍵刪除從當前行到檔案末尾的所有行：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~
....
</code></pre></div></div>

<p>Press u three times to undo the deletion.</p>

<p>連續按下 u 按鍵三次，來恢復刪除部分。</p>

<p>Cutting, Copying And Pasting Text</p>

<h4 id="剪下複製和貼上文字">剪下，複製和貼上文字</h4>

<p>The d command not only deletes text, it also “cuts” text. Each time we use the d
command the deletion is copied into a paste buffer (think clipboard) that we can later
recall with the p command to paste the contents of the buffer after the cursor or the P
command to paste the contents before the cursor.</p>

<p>這個 d 命令不僅刪除文字，它還“剪下”文字。每次我們使用 d 命令，刪除的部分被複制到一個
貼上緩衝區中（看作剪下板）。過後我們執行小 p 命令把剪下板中的文字貼上到游標位置之後，
或者是大 P 命令把文字貼上到游標之前。</p>

<p>The y command is used to “yank” (copy) text in much the same way the d command is
used to cut text. Here are some examples combining the y command with various
movement commands:</p>

<p>y 命令用來“拉”（複製）文字，和 d 命令剪下文字的方式差不多。這裡有些把 y 命令和各種移動命令
結合起來使用的範例：</p>

<table class="multi">
<caption class="cap">Table13- 4: Yanking Commands </caption>
<tr>
<th class="title">Command</th>
<th class="title">Copies</th>
</tr>
<tr>
<td valign="top" width="25%">yy</td>
<td valign="top">The current line.</td>
</tr>
<tr>
<td valign="top">5yy</td>
<td valign="top">The current line and the next four lines.</td>
</tr>
<tr>
<td valign="top">yW</td>
<td valign="top">From the current cursor position to the beginning of
the next word.</td>
</tr>
<tr>
<td valign="top">y$</td>
<td valign="top">From the current cursor location to the end of the current
line.</td>
</tr>
<tr>
<td valign="top">y0</td>
<td valign="top">From the current cursor location to the beginning of
the line.</td>
</tr>
<tr>
<td valign="top">y^</td>
<td valign="top">From the current cursor location to the first non-
whitespace character in the line.</td>
</tr>
<tr>
<td valign="top">yG</td>
<td valign="top">From the current line to the end of the file.</td>
</tr>
<tr>
<td valign="top">y20G</td>
<td valign="top">From the current line to the twentieth line of the file.</td>
</tr>
</table>

<table class="multi">
<caption class="cap">表13-4: 複製命令 </caption>
<tr>
<th class="title">命令</th>
<th class="title">複製的內容</th>
</tr>
<tr>
<td valign="top" width="25%">yy</td>
<td valign="top">當前行。</td>
</tr>
<tr>
<td valign="top">5yy</td>
<td valign="top">當前行及隨後的四行文字。</td>
</tr>
<tr>
<td valign="top">yW</td>
<td valign="top">從當前游標位置到下一個單詞的開頭。</td>
</tr>
<tr>
<td valign="top">y$</td>
<td valign="top">從當前游標位置到當前行的末尾。</td>
</tr>
<tr>
<td valign="top">y0</td>
<td valign="top">從當前游標位置到行首。</td>
</tr>
<tr>
<td valign="top">y^</td>
<td valign="top">從當前游標位置到文字行的第一個非空字元。</td>
</tr>
<tr>
<td valign="top">yG</td>
<td valign="top">從當前行到檔案末尾。</td>
</tr>
<tr>
<td valign="top">y20G</td>
<td valign="top">從當前行到檔案的第20行。</td>
</tr>
</table>

<p>Let's try some copy and paste. Place the cursor on the first line of the text and type yy to
copy the current line. Next, move the cursor to the last line (G) and type p to paste the
line below the current line:</p>

<p>我們試著做些複製和貼上工作。把游標放到文字第一行，輸入 yy 來複制當前行。下一步，把游標移到
最後一行（G），輸入小寫的 p 把複製的一行貼上到當前行的下面：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The quick brown fox jumped over the lazy dog. It was cool.
Line 2
Line 3
Line 4
Line 5
The quick brown fox jumped over the lazy dog. It was cool.
</code></pre></div></div>

<p>Just as before, the u command will undo our change. With the cursor still positioned on
the last line of the file, type P to paste the text above the current line:</p>

<p>和以前一樣，u 命令會撤銷我們的修改。這時游標仍位於檔案的最後一行，輸入大寫的 P 命令把
所複製的文字貼上到當前行之上：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The quick brown fox jumped over the lazy dog. It was cool.
Line 2
Line 3
Line 4
The quick brown fox jumped over the lazy dog. It was cool.
Line 5
</code></pre></div></div>

<p>Try out some of the other y commands in the table above and get to know the behavior of
both the p and P commands. When you are done, return the file to its original state.</p>

<p>試著執行上表中其他的一些 y 命令，瞭解小寫 p 和大寫 P 命令的行為。當你完成練習之後，把檔案
恢復原樣。</p>

<p>Joining Lines</p>

<h4 id="連線行">連線行</h4>

<p>vi is rather strict about its idea of a line. Normally, it is not possible to move the cursor
to the end of a line and delete the end-of-line character to join one line with the one
below it. Because of this, vi provides a specific command, J (not to be confused with j,
which is for cursor movement) to join lines together.</p>

<p>vi 對於行的概念相當嚴格。通常，使用者不可能透過刪除“行尾結束符”（end-of-line character）來連線
當前行和它下面的一行。由於這個原因，vi 提供了一個特定的命令，大寫的 J（不要與小寫的 j 混淆了，
j 是用來移動游標的）用於連結行與行。</p>

<p>If we place the cursor on line 3 and type the J command, here’s what happens:</p>

<p>如果我們把游標放到 line 3上，輸入大寫的 J 命令，看看發生什麼情況：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The quick brown fox jumped over the lazy dog. It was cool.
Line 2
Line 3 Line 4
Line 5
</code></pre></div></div>

<p>Search And Replace</p>

<h3 id="查詢和替換">查詢和替換</h3>

<p>vi has the ability to move the cursor to locations based on searches. It can do this on
both a single line or over an entire file. It can also perform text replacements with or
without confirmation from the user.</p>

<p>vi 能把游標移到搜尋到的匹配項上。vi 不僅能在搜尋一特定行，還能進行全文搜尋。
它也可以在有或沒有使用者確認的情況下實現文字替換。</p>

<p>Searching Within A Line</p>

<h4 id="查詢一行">查詢一行</h4>

<p>The f command searches a line and moves the cursor to the next instance of a specified
character. For example, the command fa would move the cursor to the next occurrence
of the character “a” within the current line. After performing a character search within a
line, the search may be repeated by typing a semicolon.</p>

<p>f 命令能搜尋一特定行，並將游標移動到下一個匹配的字元上。例如，命令 fa 會把游標定位到同一行中
下一個出現的”a”字元上。在進行了一次行內搜尋後，輸入分號能重複這次搜尋。</p>

<p>Searching The Entire File</p>

<h4 id="查詢整個檔案">查詢整個檔案</h4>

<p>To move the cursor to the next occurrence of a word or phrase, the / command is used.
This works the same way as we learned earlier in the less program. When you type the
/ command a “/” will appear at the bottom of the screen. Next, type the word or phrase
to be searched for, followed by the Enter key. The cursor will move to the next
location containing the search string. A search may be repeated using the previous search
string with the n command. Here’s an example:</p>

<p>移動游標到下一個出現的單詞或短語上，使用 / 命令。這個命令和我們之前在 less 程式中學到
的一樣。當你輸入/命令後，一個”/”字元會出現在螢幕底部。接下來，輸入要查詢的單詞或短語，
按下回車。游標就會移動到下一個包含所查詢字串的位置。透過 n 命令來重複先前的查詢。
這裡有個例子：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The quick brown fox jumped over the lazy dog. It was cool.
Line 2
Line 3
Line 4
Line 5
</code></pre></div></div>

<p>Place the cursor on the first line of the file. Type:</p>

<p>移動游標到檔案的第一行。輸入：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/Line
</code></pre></div></div>

<p>followed by the Enter key. The cursor will move to line 2. Next, type n and the cursor
will move to line 3. Repeating the n command will move the cursor down the file until it
runs out of matches. While we have so far only used words and phrases for our search
patterns, vi allows the use of regular expressions, a powerful method of expressing
complex text patterns. We will cover regular expressions in some detail in a later chapter.</p>

<p>然後敲回車。游標會移動到第二行。然後輸入 n，這時游標移動到第三行。重複鍵入 n 命令，游標會
繼續向下移動直到遍歷所有的匹配項。至此我們只是透過輸入單詞和短語進行搜尋，但 vi 支援正則
表示式，一種用於表達複雜文字的方法。我們將會在之後的章節中詳細講解正則表示式。</p>

<p>Global Search And Replace</p>

<h4 id="全域性查詢和替代">全域性查詢和替代</h4>

<p>vi uses an ex command to perform search and replace operations (called “substitution”
in vi) over a range of lines or the entire file. To change the word “Line” to “line” for the
entire file, we would enter the following command:</p>

<p>vi 使用 ex 命令來執行查詢和替代操作（vi 中叫做“替換”）。將整個檔案中的單詞“Line”更改為“line”，
輸入以下命令：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:%s/Line/line/g
</code></pre></div></div>

<p>Let's break this command down into separate items and see what each one does:</p>

<p>我們把這個命令分解為幾個單獨的部分，看一下每部分的含義：</p>

<table class="multi">
<tr>
<th class="title">Item</th>
<th class="title">Meaning</th>
</tr>
<tr>
<td valign="top" width="25%">:</td>
<td valign="top">The colon character starts an ex command.</td>
</tr>
<tr>
<td valign="top">%</td>
<td valign="top">Specifies the range of lines for the operation. % is a shortcut
meaning from the first line to the last line. Alternately, the
range could have been specified 1,5 (since our file is five
lines long), or 1,$ which means “from line 1 to the last line in
the file.” If the range of lines is omitted, the operation is only
performed on the current line.</td>
</tr>
<tr>
<td valign="top">s</td>
<td valign="top">Specifies the operation. In this case, substitution (search and
replace).</td>
</tr>
<tr>
<td valign="top">/Line/line</td>
<td valign="top">The search pattern and the replacement text.
</td>
</tr>
<tr>
<td valign="top">g</td>
<td valign="top">This means “global” in the sense that the search and replace is
performed on every instance of the search string in the line. If omitted,
only the first instance of the search string on each line is replaced.</td>
</tr>
</table>

<table class="multi">
<tr>
<th class="title">條目</th>
<th class="title">含義</th>
</tr>
<tr>
<td valign="top" width="25%">:</td>
<td valign="top">冒號字元執行一個 ex 命令。</td>
</tr>
<tr>
<td valign="top">%</td>
<td valign="top">指定要操作的行數。% 是一個快捷方式，表示從第一行到最後一行。另外，操作範圍也
可以用 1,5 來代替（因為我們的檔案只有5行文字），或者用 1,$ 來代替，意思是 “ 從第一行到檔案的最後一行。”
如果省略了文字行的範圍，那麼操作只對當前行生效。</td>
</tr>
<tr>
<td valign="top">s</td>
<td valign="top">指定操作。在這種情況下是，替換（查詢與替代）。</td>
</tr>
<tr>
<td valign="top">/Line/line</td>
<td valign="top">查詢型別與替代文字。</td>
</tr>
<tr>
<td valign="top">g</td>
<td valign="top">這是“全域性”的意思，意味著對文字行中所有匹配的字串執行查詢和替換操作。如果省略 g，則
只替換每個文字行中第一個匹配的字串。</td>
</tr>
</table>

<p>After executing our search and replace command our file looks like this:</p>

<p>執行完查詢和替代命令之後，我們的檔案看起來像這樣：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The quick brown fox jumped over the lazy dog. It was cool.
line 2
line 3
line 4
line 5
</code></pre></div></div>

<p>We can also specify a substitution command with user confirmation. This is done by
adding a “c” to the end of the command. For example:</p>

<p>我們也可以指定一個需要使用者確認的替換命令。透過新增一個”c”字元到這個命令的末尾，來完成
這個替換命令。例如：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:%s/line/Line/gc
</code></pre></div></div>

<p>This command will change our file back to its previous form; however, before each
substitution, vi stops and asks us to confirm the substitution with this message:</p>

<p>這個命令會把我們的檔案恢復先前的模樣；然而，在執行每個替換命令之前，vi 會停下來，
透過下面的資訊，來要求我們確認這個替換：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>replace with Line (y/n/a/q/l/^E/^Y)?
</code></pre></div></div>

<p>Each of the characters within the parentheses is a possible choice as follows:</p>

<p>括號中的每個字元都是一個可能的選擇，如下所示：</p>

<table class="multi">
<caption class="cap">Table 13-5: Replace Confirmation Keys</caption>
<tr>
<th class="title">Key</th>
<th class="title">Action</th>
</tr>
<tr>
<td valign="top" width="25%">y</td>
<td valign="top">Perform the substitution.</td>
</tr>
<tr>
<td valign="top">n</td>
<td valign="top">Skip this instance of the pattern.</td>
</tr>
<tr>
<td valign="top">a</td>
<td valign="top">Perform the substitution on this and all subsequent instances
of the pattern.</td>
</tr>
<tr>
<td valign="top">q or esc</td>
<td valign="top">Quit the substitution.</td>
</tr>
<tr>
<td valign="top">l</td>
<td valign="top">Perform this substitution and then quit. Short for"last".</td>
</tr>
<tr>
<td valign="top">Ctrl-e, Ctrl-y</td>
<td valign="top">Scroll down and scroll up, respectively. Useful for viewing
the context of the proposed substitution.</td>
</tr>
</table>

<table class="multi">
<caption class="cap">表13-5: 替換確認按鍵</caption>
<tr>
<th class="title">按鍵</th>
<th class="title">行為</th>
</tr>
<tr>
<td valign="top" width="25%">y</td>
<td valign="top">執行替換操作</td>
</tr>
<tr>
<td valign="top">n</td>
<td valign="top">跳過這個匹配的範例</td>
</tr>
<tr>
<td valign="top">a</td>
<td valign="top">對這個及隨後所有匹配的字串執行替換操作。</td>
</tr>
<tr>
<td valign="top">q or esc</td>
<td valign="top">退出替換操作。</td>
</tr>
<tr>
<td valign="top">l</td>
<td valign="top">執行這次替換並退出。l 是 “last” 的簡寫。</td>
</tr>
<tr>
<td valign="top">Ctrl-e, Ctrl-y</td>
<td valign="top">分別是向下滾動和向上滾動。用於檢視建議替換的上下文。</td>
</tr>
</table>

<p>If you type y, the substitution will be performed, n will cause vi to skip this instance and
move on to the next one.</p>

<p>如果你輸入 y，則執行這個替換，輸入 n 則會導致 vi 跳過這個範例，而移到下一個匹配項上。</p>

<p>Editing Multiple Files</p>

<h3 id="編輯多個檔案">編輯多個檔案</h3>

<p>It’s often useful to edit more than one file at a time. You might need to make changes to
multiple files or you may need to copy content from one file into another. With vi we
can open multiple files for editing by specifying them on the command line:</p>

<p>同時能夠編輯多個檔案是很有用的。你可能需要更改多個檔案或者從一個檔案複製內容到
另一個檔案。透過 vi，我們可以開啟多個檔案來編輯，只要在命令列中指定要編輯的檔名。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vi file1 file2 file3...
</code></pre></div></div>

<p>Let's exit our existing vi session and create a new file for editing. Type :wq to exit vi
saving our modified text. Next, we’ll create an additional file in our home directory that
we can play with. We’ll create the file by capturing some output from the ls command:</p>

<p>我們先退出已經存在的 vi 會話，然後建立一個新檔案來編輯。輸入:wq 來退出 vi 並且儲存了所做的修改。
下一步，我們將在家目錄下建立一個額外的用來玩耍的檔案。透過獲取從 ls 命令的輸出，來建立這個檔案。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[me@linuxbox ~]$ ls -l /usr/bin &gt; ls-output.txt
</code></pre></div></div>

<p>Let's edit our old file and our new one with vi:</p>

<p>用 vi 來編輯我們的原檔案和新建立的檔案：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[me@linuxbox ~]$ vi foo.txt ls-output.txt
</code></pre></div></div>

<p>vi will start up and we will see the first file on the screen:</p>

<p>vi 啟動，我們會看到第一個檔案顯示出來：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The quick brown fox jumped over the lazy dog. It was cool.
Line 2
Line 3
Line 4
Line 5
</code></pre></div></div>

<p>Switching Between Files</p>

<h4 id="檔案之間切換">檔案之間切換</h4>

<p>To switch from one file to the next, use this ex command:</p>

<p>從這個檔案切換下一個檔案，使用這個 ex 命令：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:n
</code></pre></div></div>

<p>To move back to the previous file use:</p>

<p>回到先前的檔案使用：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:N
</code></pre></div></div>

<p>While we can move from one file to another, vi enforces a policy that prevents us from
switching files if the current file has unsaved changes. To force vi to switch files and
abandon your changes, add an exclamation point (!) to the command.</p>

<p>當我們從一個檔案移到另一個檔案時，如果當前檔案沒有儲存修改，vi 會阻止我們切換檔案，
這是 vi 強制執行的政策。在命令之後新增感嘆號，可以強迫 vi 放棄修改而轉換檔案。</p>

<p>In addition to the switching method described above, vim (and some versions of vi) also
provide some ex commands that make multiple files easier to manage. We can view a list
of files being edited with the :buffers command. Doing so will display a list of the
files at the bottom of the display:</p>

<p>另外，上面所描述的切換方法，vim（和一些版本的 vi）也提供了一些 ex 命令，這些命令使
多個檔案更容易管理。我們可以檢視正在編輯的檔案列表，使用:buffers 命令。執行這個
命令後，螢幕頂部就會顯示出一個檔案列表：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:buffers
1 #     "foo.txt"                 line 1
2 %a    "ls-output.txt"           line 0
Press ENTER or type command to continue
</code></pre></div></div>

<p>To switch to another buffer (file), type :buffer followed by the number of the buffer
you wish to edit. For example, to switch from buffer 1 which contains the file foo.txt
to buffer 2 containing the file ls-output.txt we would type this:</p>

<p>要切換到另一個緩衝區（檔案），輸入 :buffer, 緊跟著你想要編輯的緩衝器編號。比如，要從包含檔案 foo.txt
的1號緩衝區切換到包含檔案 ls-output.txt 的2號緩衝區，我們會這樣輸入：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:buffer 2
</code></pre></div></div>

<p>and our screen now displays the second file.</p>

<p>我們的螢幕現在會顯示第二個檔案。</p>

<p>Opening Additional Files For Editing</p>

<h4 id="開啟另一個檔案並編輯">開啟另一個檔案並編輯</h4>

<p>It’s also possible to add files to our current editing session. The ex command :e (short for
“edit”) followed by a filename will open an additional file. Let's end our current editing
session and return to the command line.</p>

<p>在我們的當前的編輯會話裡也能新增別的檔案。ex 命令 :e (編輯(edit) 的簡寫) 緊跟要開啟的檔名將會開啟
另外一個檔案。 讓我們結束當前的會話回到命令列。</p>

<p>Start vi again with just one file:</p>

<p>重新啟動vi並只打開一個檔案</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[me@linuxbox ~]$ vi foo.txt
</code></pre></div></div>

<p>To add our second file, enter:</p>

<p>要加入我們的第二個檔案，輸入：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:e ls-output.txt
</code></pre></div></div>

<p>And it should appear on the screen. The first file is still present as we can verify:</p>

<p>它應該顯示在螢幕上。 我們可以這樣來確認第一個檔案仍然存在：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:buffers
 1 # "foo.txt" line 1
 2 %a "ls-output.txt" line 0
Press ENTER or type command to continue
</code></pre></div></div>

<p>Note: You cannot switch to files loaded with the :e command using either the :n
or :N command. To switch files, use the :buffer command followed by the
buffer number.</p>

<p>注意：當檔案由 ：e 命令載入，你將無法用 :n 或 :N 命令來切換檔案。
這時要使用 :buffer 命令加緩衝區號碼，來切換檔案。</p>

<p>Copying Content From One File Into Another</p>

<h4 id="跨檔案複製黏貼">跨檔案複製黏貼</h4>
<p>Often while editing multiple files, we will want to copy a portion of one file into another
file that we are editing. This is easily done using the usual yank and paste commands we
used earlier. We can demonstrate as follows. First, using our two files, switch to buffer 1
(foo.txt) by entering:</p>

<p>當我們編輯多個檔案時，經常地要複製檔案的一部分到另一個正在編輯的檔案。使用之前我們學到的
拉（yank）和貼上命令，這很容易完成。說明如下。以開啟的兩個檔案為例，首先轉換到緩衝區1（foo.txt）
，輸入：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:buffer 1
</code></pre></div></div>

<p>which should give us this:</p>

<p>我們應該得到如下輸出：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The quick brown fox jumped over the lazy dog. It was cool.
Line 2
Line 3
Line 4
Line 5
</code></pre></div></div>

<p>Next, move the cursor to the first line, and type yy to yank (copy) the line.</p>

<p>下一步，把游標移到第一行，並且輸入 yy 來複制這一行。</p>

<p>Switch to the second buffer by entering:</p>

<p>轉換到第二個緩衝區，輸入：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:buffer 2
</code></pre></div></div>

<p>The screen will now contain some file listings like this (only a portion is shown here):</p>

<p>現在螢幕會包含一些檔案列表（這裡只列出了一部分）：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>total 343700
-rwxr-xr-x 1 root root    31316  2007-12-05  08:58 [
....
</code></pre></div></div>

<p>Move the cursor to the first line and paste the line we copied from the preceding file by
typing the p command:</p>

<p>移動游標到第一行，輸入 p 命令把我們從前面檔案中複製的一行貼上到這個檔案中：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>total 343700
The quick brown fox jumped over the lazy dog. It was cool.
-rwxr-xr-x 1 root root    31316  2007-12-05  08:58 [
....
</code></pre></div></div>

<p>Inserting An Entire File Into Another</p>

<h4 id="插入整個檔案到另一個檔案">插入整個檔案到另一個檔案</h4>

<p>It’s also possible to insert an entire file into one that we are editing. To see this in action,
Let's end our vi session and start a new one with just a single file:</p>

<p>我們也可以把整個檔案插入到我們正在編輯的檔案中。看一下實際操作，結束 vi 會話，重新
啟動一個只打開一個檔案的 vi 會話：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[me@linuxbox ~]$ vi ls-output.txt
</code></pre></div></div>

<p>We will see our file listing again:</p>

<p>再一次看到我們的檔案列表：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>total 343700
-rwxr-xr-x 1 root root    31316  2007-12-05  08:58 [
</code></pre></div></div>

<p>Move the cursor to the third line, then enter the following ex command:</p>

<p>移動游標到第三行，然後輸入以下 ex 命令：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:r foo.txt
</code></pre></div></div>

<p>The :r command (short for “read”) inserts the specified file before the cursor position.
Our screen should now look like this:</p>

<p>這個:r 命令（是”read”的簡稱）把指定的檔案插入到游標位置之前。現在螢幕應該看起來像這樣：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>total 343700
-rwxr-xr-x 1 root root     31316 2007-12-05  08:58 [
....
The quick brown fox jumped over the lazy dog. It was cool.
Line 2
Line 3
Line 4
Line 5
-rwxr-xr-x 1 root root     111276 2008-01-31  13:36 a2p
....
</code></pre></div></div>

<p>Saving Our Work</p>

<h3 id="儲存工作">儲存工作</h3>

<p>Like everything else in vi, there are several different ways to save our edited files. We
have already covered the ex command :w, but there are some others we may also find
helpful.</p>

<p>像 vi 中的其它操作一樣，有幾種不同的方法來儲存我們所修改的檔案。我們已經研究了:w 這個
ex 命令， 但還有幾種方法，可能我們也覺得有幫助。</p>

<p>In command mode, typing ZZ will save the current file and exit vi. Likewise, the ex
command :wq will combine the :w and :q commands into one that will both save the
file and exit.</p>

<p>在命令模式下，輸入 ZZ 就會儲存並退出當前檔案。同樣地，ex 命令:wq 把:w 和:q 命令結合到
一起，來完成儲存和退出任務。</p>

<p>The :w command may also specify an optional filename. This acts like “Save As…” For
example, if we were editing foo.txt and wanted to save an alternate version called
foo1.txt, we would enter the following:</p>

<p>這個:w 命令也可以指定可選的檔名。這個的作用就如”Save As…“。例如，如果我們
正在編輯 foo.txt 檔案，想要儲存一個副本，叫做 foo1.txt，那麼我們可以執行以下命令：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:w foo1.txt
</code></pre></div></div>

<hr />

<p>Note: While the command above saves the file under a new name, it does not
change the name of the file you are editing. As you continue to edit, you will still
be editing foo.txt, not foo1.txt.</p>

<p>注意：當上面的命令以一個新名字儲存檔案時，它並沒有更改你正在編輯的檔案的名字。
如果你繼續編輯，你還是在編輯檔案 foo.txt，而不是 foo1.txt。</p>

<hr />

<p>Further Reading</p>

<h3 id="拓展閱讀">拓展閱讀</h3>

<p>Even with all that we have covered in this chapter, we have barely scratched the surface
of what vi and vim can do. Here are a couple of on-line resources you can use to
continue your journey towards vi mastery:</p>

<p>即使把這章所學的內容都加起來，我們也只是學了 vi 和 vim 的一點皮毛而已。這裡
有一些線上資料，可以幫助你進一步掌握 vi。</p>

<ul>
  <li>
    <p>Learning The vi Editor – A Wikibook from Wikipedia that offers a concise guide
to vi and several of its work-a-likes including vim. It’s available at:</p>
  </li>
  <li>
    <p>學習 vi 編輯器－一本來自於 Wikipedia 的 Wikibook，是一本關於 vi 的簡要指南，並
介紹了幾個類似 vi 的程式，其中包括 vim。它可以在以下連結中得到：</p>

    <p><a href="http://en.wikibooks.org/wiki/Vi">http://en.wikibooks.org/wiki/Vi</a></p>
  </li>
  <li>
    <p>The Vim Book - The vim project has a 570-page book that covers (almost) all of
the features in vim. You can find it at:</p>
  </li>
  <li>
    <p>The Vim Book－vim 專案包括一本書，570頁，（幾乎）包含了 vim 的全部特性。你能在下面連結中找到它：</p>

    <p>ftp://ftp.vim.org/pub/vim/doc/book/vimbook-OPL.pdf.</p>
  </li>
  <li>
    <p>A Wikipedia article on Bill Joy, the creator of vi.:</p>
  </li>
  <li>
    <p>Wikipedia 上關於 Bill Joy（vi 創始人）的文章。</p>

    <p><a href="http://en.wikipedia.org/wiki/Bill_Joy">http://en.wikipedia.org/wiki/Bill_Joy</a></p>
  </li>
  <li>
    <p>A Wikipedia article on Bram Moolenaar, the author of vim:</p>
  </li>
  <li>
    <p>Wikipedia 上關於 Bram Moolenaar（vim 作者）的文章：</p>

    <p><a href="http://en.wikipedia.org/wiki/Bram_Moolenaar">http://en.wikipedia.org/wiki/Bram_Moolenaar</a></p>
  </li>
  <li>
    <p>Wikipedia 上關於開頭作者提到的Chopsticks鋼琴曲的介紹：</p>

    <p>https://en.wikipedia.org/wiki/Chopsticks_(music)</p>
  </li>
  <li>
    <p>Youku 上視訊一段 Chopsticks” (The Celebrated Chop Waltz) on Piano：</p>

    <p>http://v.youku.com/v_show/id_XMzEyOTk4ODkwMA==.html</p>
  </li>
</ul>


<br />
<a href="index.html" class= "footer" >Go to Table of Contents</a>
</body>
</div>
</html>
